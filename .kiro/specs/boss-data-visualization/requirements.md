# BOSS 数据统计可视化工具 - 需求文档

## 1. 项目概述

开发一个交互式数据可视化工具，用于分析和对比两位用户的每日运营数据。该工具将从 Excel 文件中自动识别用户名，提供灵活的日期范围筛选和多指标对比功能。支持任意两个用户的数据对比。

## 2. 用户故事

### 2.1 数据加载与解析
**作为** 数据分析人员  
**我想要** 自动加载和解析 Excel 文件中的运营数据  
**以便** 无需手动处理数据格式即可开始分析

**验收标准：**
- 系统能够读取 BOSS数据统计.xlsx 文件
- 自动从 Excel 表头识别两位用户的姓名（左侧为用户1，右侧为用户2）
- 将 Excel 日期序列号（如 45957）转换为标准日期格式（YYYY-MM-DD）
- 正确解析四个数据字段：曝光、新招呼、交换微信、添加微信
- 处理缺失值（空单元格），不影响后续分析
- 支持任意用户名（不限于特定姓名）

### 2.2 折线图对比展示
**作为** 数据分析人员  
**我想要** 在同一张图表中对比两位用户的指标数据  
**以便** 直观地看出他们的表现差异和趋势

**验收标准：**
- 在同一张折线图中显示两位用户的数据曲线
- 支持切换不同指标（曝光、新招呼、交换微信、添加微信）
- 图表包含清晰的图例，动态显示实际用户名
- 显示网格线和数据点标记，提升可读性
- 缺失数据点不连线，避免误导性趋势

### 2.3 日期范围筛选
**作为** 数据分析人员  
**我想要** 自定义查看特定时间段的数据  
**以便** 聚焦于感兴趣的时间区间进行分析

**验收标准：**
- 提供日期范围选择器（起始日期和结束日期）
- 默认显示最近 30 天的数据
- 日期范围调整后，图表实时刷新
- 图表标题自动更新，显示当前日期范围、用户名和指标名称
- 支持数据文件中的完整日期范围

### 2.4 指标选择
**作为** 数据分析人员  
**我想要** 快速切换不同的运营指标  
**以便** 从多个维度分析用户表现

**验收标准：**
- 提供下拉菜单选择指标
- 支持的指标：曝光、新招呼、交换微信、添加微信、补刀次数
- 指标切换后图表立即更新
- 图表标题和 Y 轴标签反映当前选择的指标

### 2.4.1 双指标对比（新增功能）
**作为** 数据分析人员  
**我想要** 同时对比两个不同的指标  
**以便** 发现指标之间的关联性和趋势差异

**验收标准：**
- 提供对比模式选择（单指标对比/双指标对比）
- 双指标模式下可以选择两个不同的指标
- 使用双Y轴图表展示，左Y轴显示指标1，右Y轴显示指标2
- 不同指标使用不同线型（实线/虚线）和颜色区分
- 图表包含4条曲线：两个用户 × 两个指标
- 显示两个指标的统计摘要
- 防止选择相同的两个指标

### 2.5 转化率分析（可选）
**作为** 数据分析人员  
**我想要** 查看关键转化率指标  
**以便** 评估运营效率而不仅仅是绝对数值

**验收标准：**
- 计算并显示"添加微信转化率"（添加微信 / 交换微信 × 100%）
- 转化率以百分比形式展示
- 避免除零错误（当分母为 0 时显示 N/A 或跳过）

### 2.6 图表导出
**作为** 数据分析人员  
**我想要** 导出生成的图表  
**以便** 在报告或演示中使用

**验收标准：**
- 支持导出为 PNG 格式
- 支持导出为 PDF 格式（可选）
- 导出的图表保持清晰度和完整性
- 文件名包含日期范围和指标信息

## 3. 技术需求

### 3.1 数据处理
- 使用 Pandas 读取和处理 Excel 文件
- 使用 openpyxl 作为 Excel 引擎
- 实现 Excel 日期序列号到标准日期的转换函数
- 支持同时提取多个指标的数据

### 3.2 可视化
- 使用 Plotly 生成交互式图表
- 支持单指标对比折线图
- 支持双指标对比双Y轴图表
- 使用 make_subplots 实现双Y轴功能

### 3.3 用户界面
- 使用 Streamlit 构建 Web 界面
- 响应式布局，适配不同屏幕尺寸
- 简洁直观的操作界面

### 3.4 性能
- 数据加载时间 < 2 秒
- 图表刷新时间 < 1 秒
- 支持的数据量：至少 365 天的数据

## 4. 非功能性需求

### 4.1 可用性
- 界面语言：中文
- 无需技术背景即可操作
- 提供清晰的错误提示

### 4.2 可维护性
- 代码结构清晰，模块化设计
- 关键函数包含注释
- 易于添加新的指标或用户

### 4.3 兼容性
- 支持 Python 3.8+
- 支持主流浏览器（Chrome、Firefox、Edge）
- 支持 Windows、macOS、Linux

## 5. 约束条件

- Excel 文件格式固定：左侧为用户1数据，右侧为用户2数据
- 数据字段固定：曝光、新招呼、补刀次数、交换微信、添加微信（共5个指标）
- 仅支持两个用户的对比（不支持3个或更多用户同时对比）
- 用户名从 Excel 第一行自动读取（列0和列7）
- 支持单指标对比和双指标对比两种模式

## 6. 未来扩展（不在当前范围）

- 支持 3 个或更多用户的同时对比
- 支持多个 Excel 文件的批量处理
- 添加更多图表类型（柱状图、饼图、热力图）
- 数据库存储历史数据
- 用户权限管理
- 自动化报告生成和邮件发送
- 移动端适配
